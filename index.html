<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Story Polisher Ultimate ğŸŒˆ</title>
<style>
  :root {
    --bg1:#8f6aff; --bg2:#66d0ff; --bg3:#f6b0ff;
    --text:#111; --card:#fff; --accent:#5b3eff;
  }
  body.dark {
    --bg1:#1e1e2a; --bg2:#2a1e3d; --bg3:#3d2a6d;
    --text:#f9f9f9; --card:#2b2b3c; --accent:#9b7bff;
  }

  body{
    font-family:Poppins, sans-serif;
    background:linear-gradient(135deg,var(--bg1),var(--bg2),var(--bg3));
    background-size:400% 400%;
    animation:gradient 10s ease infinite;
    text-align:center;padding:20px;color:var(--text);
    transition:.5s;
  }
  @keyframes gradient{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
  h1{text-shadow:1px 1px rgba(0,0,0,.3);color:var(--text);}
  textarea{
    width:90%;height:200px;margin-top:10px;border:2px solid var(--accent);
    border-radius:12px;padding:10px;font-size:16px;resize:none;background:var(--card);color:var(--text);
  }
  button{
    margin:8px 4px;padding:10px 18px;border:none;border-radius:10px;
    background:var(--accent);color:#fff;font-size:15px;cursor:pointer;transition:.2s;
  }
  button:hover{transform:scale(1.07);}
  #micButton{background:radial-gradient(circle,#a389ff 20%,var(--accent) 90%);box-shadow:0 0 20px rgba(91,62,255,.5);}
  #micButton.glow{box-shadow:0 0 40px #a389ff;}
  #output{
    width:90%;margin:20px auto;background:var(--card);
    padding:15px;border-radius:10px;box-shadow:0 0 10px #0002;text-align:left;
  }
  #wordCount{margin-top:10px;font-weight:bold;}
  #modeToggle{position:fixed;top:10px;right:15px;background:var(--accent);}
</style>
</head>
<body>
<h1>ğŸ™ Story Polisher Ultimate ğŸŒˆ</h1>
<button id="modeToggle" onclick="toggleMode()">ğŸŒ™ Dark</button>

<textarea id="storyInput" placeholder="Type or speak your story here..."></textarea><br>

<button id="micButton" onclick="startVoiceInput()">ğŸ¤ Speak</button>
<button onclick="polishStory()">ğŸª„ Polish</button>
<button onclick="gradeStory()">ğŸ“Š Grade</button>
<button onclick="explainGrade()">ğŸ’¬ Explain</button>
<button onclick="compareMode()">ğŸª Compare</button>
<button onclick="moodMeter()">ğŸ§  Mood</button>
<button onclick="challengeOfTheDay()">ğŸŒˆ Challenge</button>
<button onclick="saveStory()">ğŸ’¾ Save</button>
<button onclick="shareStory()">ğŸ’¬ Share</button>

<div id="wordCount">Words: 0</div>
<div id="output"></div>

<script>
let originalStory="",polishedStory="",lastGrade="",xp=0,level=1;

//ğŸŒ™ toggle
function toggleMode(){
  document.body.classList.toggle('dark');
  document.getElementById('modeToggle').textContent=
    document.body.classList.contains('dark')?'â˜€ï¸ Light':'ğŸŒ™ Dark';
}

//ğŸ¤ voice input
function startVoiceInput(){
  const mic=document.getElementById('micButton');
  if(!('webkitSpeechRecognition' in window))return alert("Not supported.");
  const rec=new webkitSpeechRecognition();
  rec.lang="en-US"; rec.interimResults=false;
  mic.classList.add('glow');
  document.getElementById('output').innerHTML="<p>ğŸ¤ Listening...</p>";
  rec.start();
  rec.onresult=e=>{
    const text=e.results[0][0].transcript;
    document.getElementById('storyInput').value=text;
    document.getElementById('output').innerHTML=`<p>ğŸ“ ${text}</p>`;
    mic.classList.remove('glow');
  };
  rec.onerror=e=>{mic.classList.remove('glow');document.getElementById('output').innerHTML=`<p>âš ï¸ ${e.error}</p>`;}
}

//ğŸª„ polish
function polishStory(){
  const s=document.getElementById('storyInput').value;
  if(!s.trim())return alert("Write first!");
  originalStory=s;
  polishedStory=s.replace(/\bvery\b/g,"extremely").replace(/\bsaid\b/g,"remarked").replace(/\bhappy\b/g,"joyful");
  document.getElementById('output').innerHTML=`<h3>âœ¨ Polished:</h3><p>${polishedStory}</p>`;
}

//ğŸ“Š grade + XP
function gradeStory(){
  const s=document.getElementById('storyInput').value;
  if(!s.trim())return alert("Write first!");
  const score=Math.min(100,Math.floor(Math.random()*20+80));
  const letter=score>90?"A":score>80?"B":"C";lastGrade=letter;
  const words=s.split(/\s+/).length;
  const gain=Math.floor(words/10)+(letter=="A"?20:letter=="B"?10:5);
  xp+=gain;if(xp>=level*100){level++;alert(`ğŸ‰ Level up! Now ${level}`);}
  document.getElementById('output').innerHTML=`<h3>Grade ${letter} (${score}/100)</h3><p>+${gain} XP | Total: ${xp} | Lv ${level}</p>`;
}

//ğŸ’¬ explain
function explainGrade(){
  if(!lastGrade)return alert("Grade first!");
  const exp={A:"Excellent creativity and grammar!",B:"Solid work, minor issues.",C:"Needs more detail and variety."};
  document.getElementById('output').innerHTML=`<h3>Why ${lastGrade}</h3><p>${exp[lastGrade]}</p>`;
}

//ğŸª compare
function compareMode(){
  if(!polishedStory)return alert("Polish first!");
  document.getElementById('output').innerHTML=
  `<h3>Before / After</h3>
   <div style="display:flex;gap:10px;">
   <div style="flex:1;background:#eee;padding:10px;border-radius:10px;"><b>Before:</b><br>${originalStory}</div>
   <div style="flex:1;background:#e8f9f3;padding:10px;border-radius:10px;"><b>After:</b><br>${polishedStory}</div>
   </div>`;
}

//ğŸ§  mood
function moodMeter(){
  const t=document.getElementById("storyInput").value.toLowerCase();
  if(!t.trim())return alert("Write first!");
  const moods={happy:["joy","smile","love","fun"],sad:["cry","tears","alone"],angry:["mad","rage","fight"],scary:["ghost","fear","dark"]};
  let counts={happy:0,sad:0,angry:0,scary:0};
  for(let m in moods)moods[m].forEach(w=>{const mth=t.match(new RegExp("\\b"+w+"\\b","g"));if(mth)counts[m]+=mth.length;});
  let top=Object.keys(counts).reduce((a,b)=>counts[a]>counts[b]?a:b);
  const em={happy:"ğŸ˜„",sad:"ğŸ˜¢",angry:"ğŸ˜¡",scary:"ğŸ‘»"}[top];
  document.getElementById("output").innerHTML=`<h3>Mood ${em}</h3><p>${top.toUpperCase()}<br>${JSON.stringify(counts)}</p>`;
}

//ğŸŒˆ challenge
function challengeOfTheDay(){
  const arr=[
  "50-word story about a talking sandwich ğŸ¥ª",
  "Describe joy without 'happy' ğŸŒ",
  "Scary story ending 'It was only a dream.' ğŸ‘»",
  "Story where each sentence starts with same letter âœï¸",
  "Superhero afraid of water ğŸ’§"];
  const r=arr[Math.floor(Math.random()*arr.length)];
  document.getElementById("output").innerHTML=`<h3>ğŸ¯ Challenge</h3><p>${r}</p>`;
}

//ğŸ’¾ save / share
function saveStory(){
  const s=document.getElementById("storyInput").value;
  if(!s.trim())return alert("Nothing to save!");
  localStorage.setItem("savedStory",s);
  alert("âœ… Saved locally!");
}
function shareStory(){
  const s=document.getElementById("storyInput").value;
  if(!s.trim())return alert("Write first!");
  navigator.clipboard.writeText(s).then(()=>alert("ğŸ“‹ Copied to clipboard!"));
}

//ğŸ“ˆ word count
const tA=document.getElementById("storyInput"),wc=document.getElementById("wordCount");
tA.addEventListener("input",()=>{
  const c=tA.value.trim()?tA.value.trim().split(/\s+/).length:0;
  wc.textContent=`Words: ${c}`;
});
</script>
</body>
</html>
